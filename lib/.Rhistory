geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(term %in% c("nation", "power", "public", "world", "relationship")) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
p
year_term_counts %>%
filter(term %in% c("nation", "nations", "power", "world", "war", "great")) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(term %in% c("nation", "nations", "power", "world", "war", "great", "help")) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(term %in% c("nation", "nations", "power", "world", "war", "great")) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(term %in% c("nation", "power", "world", "war", "great")) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
words<- read.xlsx("../data/inquirerbasic.xlsx")
words<- read.xlsx("../data/inquirerbasic.xlsx", sheetIndex=1)
words<- read.xlsx("../data/try.xlsx", sheetIndex=1)
View(words)
words<- read.xlsx("../data/inquirerbasic.xlsx", sheetIndex=1)
words<- read.xlsx("../data/inquirerbasic.xlsx", sheetIndex=1)
inqdict <- read.csv("~/Desktop/inqdict.txt", sep="")
View(inqdict)
inqdict <- read.delim("~/Desktop/inqdict.txt")
View(inqdict)
inquirerbasic <- read.csv("~/Desktop/inquirerbasic.xlsx", sep="")
View(inquirerbasic)
words<- read.xlsx("../data/inquirerbasic_i.xlsx", sheetIndex=1)
words<- read.csv("../data/inquirerbasic_i.csv")
View(words)
words<- read.csv("../data/inquirerbasic.csv")
View(words)
View(words)
words[, "Work"==Work]
words[,"Relig"== Relig]
words[,"Relig"== "Relig"]
words$Relig=="Relig"
?filter
filter(words,  words$Relig=="Relig")
try1<-filter(words,  words$Relig=="Relig")
View(try1)
try1[,]
try1[,1]
year_term_counts %>%
filter(term %in% try1[,1]) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
catword<-try1[,1]
catword<-as.vector(try1[,1])
year_term_counts %>%
filter(term %in% catword) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(catword) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
View(year_term_counts)
year_term_counts %>%
filter(term==catword) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(term %in% c("god", "effect")) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
catword
year_term_counts %>%
filter(term %in% as.vector(try1[,1])) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
year_term_counts %>%
filter(term %in% catword[5]) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
catword
catword<-Corpus(catword)
?tm_map
try1<-filter(words,  words$Relig=="Relig")
catword<-try1[,1]
catword<-tolower(catword)
year_term_counts %>%
filter(term %in% catword) %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
View(year_term_counts)
View(year_term_counts)
year_term_counts %>%
filter(term %in% catword) %>%
ggplot(aes(index, sum(count) / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
View(year_term_counts)
try2<-filter(year_term_counts, term %in% catword)
View(try2)
View(try2)
try2 %>%
group_by(index) %>%
summarize(Count=sum(Count))
try2 %>%
group_by(index) %>%
summarize(count=sum(count))
try3<- try2 %>%
group_by(index) %>%
summarize(count=sum(count))
View(try3)
View(try3)
try3<- try2 %>%
group_by(index) %>%
summarise_each(funs(sum))
View(try2)
try3<- try2 %>%
group_by(index) %>%
summarise_each(funs(count))
try3<- try2 %>%
group_by(index) %>%
summarize_each(funs(count))
try3<- tapply(try2$count, try2$index, FUN=sum)
try3<- tapply(try2$count, try2$index, FUN=sum/year_total)
aggregate(count~index, try2, sum)
year_term_counts$index==2
year_term_count[year_term_counts$index==2, year_total]
year_term_counts[year_term_counts$index==2, year_total]
year_term_counts[year_term_counts$index==2, 5]
year_term_counts[year_term_counts$index==2, 5][1]
year_term_counts[year_term_counts$index==2, 5][[1]]
yearcount<-year_term_counts[year_term_counts$index==2, 5]
yearcount[1]
View(yearcount)
yearcount[1,1]
yearcount[[1]]
yearcount<-year_term_counts[year_term_counts$index==2, 5][,1]
year_term_counts[year_term_counts$index==2, 5][,1]
year_term_counts[year_term_counts$index==2, 5][1,1]
as.logical(year_term_counts[year_term_counts$index==2, 5][1,1])
as.vector((year_term_counts[year_term_counts$index==2, 5][1,1]))
yearcount<-as.vector((year_term_counts[year_term_counts$index==2, 5][1,1]))
View(yearcount)
yearcount<-as.numeric((year_term_counts[year_term_counts$index==2, 5][1,1]))
year_total= rep(NA, 58)
for (i in 1:58) {
year_total[i]=as.numeric((year_term_counts[year_term_counts$index==i, 5][1,1]))}
year_total
View(year_term_counts)
catfunc<- function(cat){
for (i in 1:length(cat)){
group<- cat[i]
dat<- filter(words, words$cat[i]=="cat[i]")
datword<-try1[,1]
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
finalldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
}
}
cat<- c("Relig", "Work")
category<-c("Relig", "Work")
catfunc(category)
library(dplyr)
Q
library(dplyr)
catfunc(category)
library(sp)
install.packages("sp")
catfunc(category)
group<-cat[1]
dat<- filter(words, words$cat[1]=="cat[1]")
cat[1]
dat<- filter(words, words$group=="group")
words$group
group<- as.character(cat[1])
dat<- filter(words, words$group=="group")
cat[1]
cat[2]
View(words)
words$group
?as.
group<-toString(cat[1])
mode(group)
dat<- filter(words, words$group=="group")
colnames(words)
which(colnames(words)=="group")
which(colnames(words)==group)
colnames(words)[34]
group<-cat[1]
colno<-which(colnames(words)==cat[1])
dat<- filter(words, words[, colno]==cat[1])
View(dat)
cat
catfunc<- function(cat){
for (i in 1:length(cat)){
colno<-which(colnames(words)==cat[i])
dat<- filter(words, words[, colno]==cat[i])
datword<-dat[,1]
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
return(finalldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address"))}
}
category
catfunc(category)
datword<-dat[,1]
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
dat<-filter(year_term_counts, term %in% datword)
datword<-as.vector(dat[,1])
dat<- filter(words, words[, colno]==cat[1])
datword<-as.vector(dat[,1])
dat<-filter(year_term_counts, term %in% datword)
View(dat)
dat<- filter(words, words[, colno]==cat[1])
datword<-as.vector(dat[,1])
View(try2)
try1<-filter(words,  words$Relig=="Relig")
catword<-try1[,1]
try2<- filter(year_term_counts, term%in% catword)
View(try1)
catword<-tolower(try1[,1])
try2<- filter(year_term_counts, term%in% catword)
datword<-tower(dat[,1]))
datword<-tower(dat[,1])
catfunc<- function(cat){
for (i in 1:length(cat)){
colno<-which(colnames(words)==cat[i])
dat<- filter(words, words[, colno]==cat[i])
datword<-tolwer(dat[,i])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
return(finalldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address"))}
}
catfunc(category)
catfunc<- function(cat){
for (i in 1:length(cat)){
colno<-which(colnames(words)==cat[i])
dat<- filter(words, words[, colno]==cat[i])
datword<-tolower(dat[,i])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
return(finalldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address"))}
}
catfunc(category)
catfunc<- function(cat){
for (i in 1:length(cat)){
colno<-which(colnames(words)==cat[i])
dat<- filter(words, words[, colno]==cat[i])
datword<-tolower(dat[,i])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
return(finaldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address"))}
}
catfunc(category)
catfunc<- function(cat) {
for (i in 1:length(cat)){
colno<-which(colnames(words)==cat[i])
dat<- filter(words, words[, colno]==cat[i])
datword<-tolower(dat[,1])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
finaldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address"))}
}
catfunc<- function(cat) {
for (i in 1:length(cat)){
colno<-which(colnames(words)==cat[i])
dat<- filter(words, words[, colno]==cat[i])
datword<-tolower(dat[,1])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
finaldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")}
}
catfunc(category)
catfunc<- function(cat) {
for (i in cat){
colno<-which(colnames(words)==i)
dat<- filter(words, words[, colno]==i)
datword<-tolower(dat[,1])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
countplot<- finaldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
ggtitle(paste("Category:", i, sep="")) +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")+
ggsave(countplot, file=paste("Category",i,".jpeg", sep="")) }
}
catfunc(category)
catfunc<- function(cat) {
for (i in cat){
colno<-which(colnames(words)==i)
dat<- filter(words, words[, colno]==i)
datword<-tolower(dat[,1])
dat<-filter(year_term_counts, term %in% datword)
finaldat<- dat %>% group_by(index) %>% summarize(count=sum(count))
finaldat$year_total<- year_total
countplot<- finaldat %>%
ggplot(aes(index, count / year_total)) +
geom_point() +
geom_smooth() +
ggtitle(paste("Category:", i, sep="")) +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
ggsave(countplot, file=paste("Category",i,".jpeg", sep="")) }
}
catfunc(category)
category<- c("Work", "Perceive", "Object", "Relig", "TimeSpc", "Natrpro", "NatObj", "Abs@")
catfunc(category)
category<- c("Relig", "Object")
catfunc(category)
category<- c("Work", "Object", "Relig", "TimeSpc", "Natrpro", "NatObj", "Abs@")
catfunc(category)
category<- c("Work", "Object", "Relig", "TimeSpc", "Natrpro", "NatObj", "Abs")
catfunc(category)
category<- c("Work", "Object", "Relig", "TimeSpc", "Natrpro", "NatObj", "Abs.")
catfunc(category)
View(words)
colnames(words0)
colnames(words)
category
category<- c("Work", "Object", "Relig", "TimeSpc", "Natrpro", "NatObj")
catfunc(category)
category<- c("Work", "Object", "Relig", "TimeSpc", "Natrpro")
catfunc(category)
category<- c("Work", "Object", "Relig", "TimeSpc")
catfunc(category)
category<- c("Natrpro", "NatObj")
catfunc(category)
category<- c("Natrpro", "NatObj", "Perceiv", "Relig", "TimeSpc", "Abs.")
catfunc(category)
category<- c("NatrPro", "NatObj", "Perceiv", "Relig", "TimeSpc", "Abs.")
catfunc(category)
category<- c("NatrPro", "NatObj", "Perceiv", "Relig", "TimeSpc")
catfunc(category)
category<- c("NatrPro", "NatObj", "Perceiv", "Relig", "TimeSpc", "ABS")
catfunc(category)
install.packages("jpeg")
library(jpeg)
?readJPEG
categoryi<-category
shinyApp(
ui = fluidPage(
titlePanel("title panel"),
sidebarLayout(
sidebarPanel("sidebar panel",
selectInput('element_id', label='Select one option', choices=categoryi),
mainPanel("main panel",
p(textOutput('dynamicText')),
plotOutput('countcat', height = "400px")
)
),
server = function(input, output, session) {
output$countcat <- renderPlot(height = 400, {
par(mfrow=c(1,2), mar = c(0, 0, 3, 0))
for (i in categoryi) {
path<-paste("Category",i,".jpeg", sep="")
readJPEG("../lib/path", native=TRUE)}
})
},
options = list(height = 600)
)
)
library(shiny)
library(shiny)
shinyUI(fluidPage (
titlePanel("title panel"),
sidebarLayout(
sidebarPanel("sidebar panel",
selectInput('element_id', label='Select one option', choices=categoryi)),
mainPanel("main panel",
plotOutput('countcat', height = "400px")))
)
)
shinyServer = function(input, output) {
output$countcat <- renderPlot(height = 400, {
#par(mfrow=c(1,2), mar = c(0, 0, 3, 0))
images<-function(cat){
path<-paste("Category", cat , ".jpeg", sep="")
readJPEG("../lib/path", native=TRUE)}
images(categoryi)}
)
}
catfunc(categoryi)
category
knit_with_parameters('~/Desktop/Spr2017-Proj1-jt2929/doc/ADSProj1_V1.Rmd')
categoryi<-c("NatrPro","NatObj","Perceiv","Relig","TimeSpc","ABS")
catfunc(categoryi)
library(shiny)
shinyUI(fluidPage (
titlePanel("title panel"),
sidebarLayout(
sidebarPanel("sidebar panel",
selectInput('element_id', label='Select one option', choices=categoryi)),
mainPanel("main panel",
plotOutput('countcat', height = "400px")))
)
)
shinyServer = function(input, output) {
output$countcat <- renderPlot(height = 400, {
#par(mfrow=c(1,2), mar = c(0, 0, 3, 0))
images<-function(cat){
path<-paste("Category", cat , ".jpeg", sep="")
readJPEG("../lib/path", native=TRUE)}
images(categoryi)}
)
}
install.packages("rmarkdown")
install.packages("rmarkdown")
